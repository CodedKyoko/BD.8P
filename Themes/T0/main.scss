$v: 2 ;
$current_version: "0.3.4" ;
// Version
[class*="standardSidebarView-"] [class*="sidebar-"] #bd-settings-sidebar > span:after {
  content: "T0-Theme v#{$current_version} by Eight_P";
  display: block;
  font-size: 12px ;
  font-weight: 600 ;
  color: rgb(114, 118, 125);
  padding: 2px 10px;
}

// pseudo for BG darkening
@mixin BG-dark-before($height) {
  &::before {
    content: "" ;
    position: absolute ;
    top: 0 ;
    left: 0 ;
    height: $height ;
    width: 100vw ;
    background: black ;
    opacity: calc(var(--brightness) / 100 ) ;
  }
}

// Info / disclaimer
@mixin disclaimer ($text, $type) {
  
  // Header/Text
  [class*="layers-"] > [class*="layer-"]:first-child {
    
    &::before {
      content: "" ;
      position: fixed ;
      height: 100vh ;
      width: 100vw ;
      background: black ;
      opacity: .6 ;
      z-index: 3000 ;
    }
    
    > [class*="flex-"]::before {
      content: $text ;
      position: absolute ;
      top: calc(50vh - 50px) ;
      left: calc(50vw - 250px) ;
      height: 100px ;
      width: 500px ;
      background: #d8d8d8 ;
      z-index: 3001 ;
      border-radius: 15px ;
      box-sizing: border-box ;
      padding-top: 25px ;
      text-align: center ;
      color: black ;
      font-weight: 500 ;
    }
    
    // Body/Content
    @if $type == "Settings" {
        
      [class*="channels-"] > [class*="container-"]:nth-last-of-type(1) {

        > [class*="flex-"] > button {
          position: fixed ;
          top: calc(50vh) ;
          left: calc(50vw - 25px ) ;
          height: 40px ;
          width: 40px ;
          z-index: 3002 ;
          margin: 5px ;

          > [class*="contents-"] { margin-top: 0 }

          svg {
            height: 30px ;
            width: 30px ;

            path { fill: black }
          }
          &::before {
            content: 'Settings';
            position: absolute ;
            right: 50px ;
            line-height: 40px ;
            color: black ;
            font-weight: 500 ;
            font-size: 15px ;
            pointer-events: none ;
          }
        }
      }
    }
  }
}

// general Stuff
body { 
  // Background main
  background: var(--Background_Main) ;
	background: {
		size: cover ;
		attachment: fixed ;
		position: center ;
		repeat: no-repeat ;
	}
  
  // if Minimal Mode is active
  &.bd-minimal { @include disclaimer ('PLs turn off "Minimal Mode" in order to use the Theme', "Settings") }
  
  // popup in case the theme file itself needs an update
  &::before {
    content: "updated theme file available, pls check : github.com/Eight-P/BetterDiscord-Stuff" ;
    position: absolute;
    height: 22px ;
    width: 100vw ;
    background: var(--Color_3) ;
    z-index: 3000 ;
    opacity: calc( #{$v} - var(--F_V,0)) ;
    color: var(--Color_1) ;
    padding-left: 100px ;
    line-height: 22px ;
    font-size: 14px ;
    letter-spacing: .4px ;
  }
  #app-mount {
    @include BG-dark-before(100vh) ;
    // if dark-theme is not used (LuL)
    > [class*="app-"] > [class*="app-"]:not([class*="theme-dark"]) {
      @include disclaimer ('PLs use dark-mode in order to use the Theme', "Settings")
    }
  }
  // removing transition effect, also fixed flickering somehow
  [class*="layers-"] > [class*="layer-"] {
    transform: scale(1) translateZ(0px) !important ;

    &:first-child { opacity: 0 !important }
    &:last-child { opacity: 1 !important }
  }
  // pluginNotice-bar
  #pluginNotice, [class*="app-"] > [class*="notice-"]{
    position: absolute ;
    width: 100vw ;

    [class*="dismiss-"] { right: 36px }
  }
}

// Window-bar
#app-mount > [class*="app-"]::before {
  content: "" ;
  position: absolute ;
  top: 0 ;
  left: 0 ;
  height: 1px ;
  width: 100vw ;
  box-shadow: 0 -1px 0 var(--Color_2);
  opacity: .6 ;
  pointer-events: none ;
}

//Titel-bar
[class*="channels-"] {
  ~ [class*="chat-"] > [class*="title-"],
  ~ [class*="activityFeed-"] > [class*="container-"],
  ~ [class*="gameLibrary-"] [class*="libraryHeader-"],
  ~ [class*="applicationStore-"] [class*="headerBar-"],
  ~ [class*="container-"] > [class*="container-"] {
    [class*="toolbar-"] {
      //Icons
      > [class*="iconWrapper-"], > [class*="anchor-"] {
        margin: 0 9px ;

        > div { margin: 0 }

        svg {
          width: 20px ;
          color: var(--Color_1) ;
          opacity: .7 ;
        }

        &:hover svg { opacity: 1 }
      }
    }
  }
}

//Titel-bar Server-view
[class*="channels-"] ~ [class*="chat-"] [class*="title-"]{
  box-shadow: none ;
  
  //Channel info
  [class*="children-"] {
    
    // #
    [class*="iconWrapper-"] svg {
      width: 20px ;  
      color: var(--Color_2) ;
    }
    
    // Channel Name
    [class*="title-"] { color: var(--Color_1) }
    
     // Channel Topic
    [class*="topic-"] {
      color: var(--Color_1) ;
      opacity: .7 ;
    }
  }
  
  //Search
  [class*="toolbar-"] > [class*="search-"] {
    pointer-events: none ;
    margin: 0 8px ;

    //Search Bar
    > [class*="search-"] {

      [class*="searchBar-"] {
        width: 20px ;
        background: transparent ;

        // Input Container
        .DraftEditor-root {
          position: absolute ;
          width: 20px ;
          cursor: pointer ;
          pointer-events: auto ;
          
          .public-DraftEditor-content {
            
            //search text
            .public-DraftStyleDefault-block > span { display: none }
          }

          //placeholder text
          .public-DraftEditorPlaceholder-root { display: none }
        }

        [class*="icon-"] svg {
          color: var(--Color_1) ;
          transition: none ;

          &:first-child { opacity: .7 }
        }

        &:hover [class*="icon-"] svg:first-child { opacity: 1 }
      }

      //Search Bar opend
      &[class*="open-"] {
        border-bottom: 1px solid var(--Color_1) ;

        [class*="searchBar-"] {
          width: 244px ;
          transition: .3s ;

          .DraftEditor-root { 
            position: relative ;

            .public-DraftEditor-content .public-DraftStyleDefault-block > span { display: inline-block }
          }

          [class*="icon-"] svg {

            &:first-child { opacity: 0 }
            &:last-child { opacity: .7 }
          }
        }
      }
    }
  }
}

// Server-channels
[class*="channels-"] > [class*="container-"]:nth-of-type(1) {
  top: 48px ;
  margin-bottom: 48px;

  [class*="positionedContainer-"] [class*="unread-"] { padding: 0 8px }

  [class*="scroller-"] {
    
    &::-webkit-scrollbar { display: none }
    
    // Channel container
    [class*="containerDefault-"] {

      // default 
      [class*="content-"] {
        background: transparent;

        [class*="name-"] { color: var(--Color_2) }

        [class*="icon-"] {
          width: 15px ;
          color: var(--Color_2);
          opacity: .9 ;
        }
        
        // channel-options
        [class*="children-"] [class*="iconItem-"] {
          display: none ;
          color: var(--Color_2);
          opacity: .8 ;

          &:hover {
            color: var(--Color_1);
            opacity: 1 ;
          }
        }
        
        // connection-limit
        [class*="children-"] [class*="userLimit-"] [class*="wrapper-"]{
          color: var(--Color_2) ;
          
          [class*="users-"], [class*="total-"] { background: transparent }
          
          [class*="total-"]::after {
            border: none ;
            content: "|" ;
            left: -5px ;
            top: -1px ;
          }
        }
        
        // mentions indicator
        [class*="iconSpacing-"] [class*="wrapper-"] {
          background-color: transparent ;
          border-bottom: 2px solid rgba(240, 71, 71, 0.7) ;
          border-radius: 0 ;
          box-shadow: none ;
          color: var(--Color_1) ;
        }
        
        // Highlight on hover
        &:hover {
          [class*="children-"] [class*="iconItem-"] { display: block }
          [class*="name-"] { color: var(--Color_1) }
          [class*="icon-"] { color: var(--Color_1) }
        }
      }
      
      // selected, connected
      [class*="modeSelected-"], [class*="modeConnected-"] {

        [class*="name-"] { color: var(--Color_1) }

        [class*="icon-"] { 
          color: var(--Color_1);
          opacity: 1 ;
        }
      }
    }
  }
}

// Profile-, connection container
[class*="channels-"] > [class*="container-"] {

  &:nth-last-of-type(1) {
    position: absolute ;
    height: 48px ;
    width: 240px ;
    box-sizing: border-box ;

    // Avatar/Icon
    [class*="avatar-"] [class*="status-"] {
      border: none ;
      bottom: -1px ;
      right: -1px ;
    }
    
    // Custom Status Icon
    [class*="nameTag-"] [class*="customStatusWrapper-"] { display: none }
    
    // moving/fixing tooltips
    > [class*="flex-"] {
      margin-top: 20px ;

      > div { height: 22px }

      [class*="iconButtonDefault-"] { 
        margin-top: -10px ;
        background-color: transparent ;
      }
      button {
        background-color: transparent ;
        
        [class*="contents-"] { margin-top: -20px }
      }
    }
  }
  &:nth-of-type(2) { border: none }
}

// Chat
[class*="chat-"] [class*="spacer-"] {
  //Server-messages
  [class*="messagesWrapper-"] {

    [class*="scroller-"] {

      &::-webkit-scrollbar-thumb {
        background-color: var(--Color_3) ;
        border-color: transparent  ;
      }

      &::-webkit-scrollbar { width: 12px }
      
      &:hover::-webkit-scrollbar-thumb { background-color: var(--Color_2) }
    }
  }
  // Text-Input
  > form {
    margin: 5px 0 0 0 ;

    [class*="channelTextArea-"] {
      margin: 0 ;
      padding: 0 ;

      [class*="inner-"] { background: transparent }
    }
    [class*="channelTextAreaDisabled-"] [class*="innerDisabled-"]::after {
      content: " " ;
      background: url("https://i.imgur.com/za6Yq9g.png") ;
      position: absolute;
      right: 0 ;
      bottom: 0 ;
      height: 36px ;
      width: 36px ;
      background-size: cover ;
      background-repeat: no-repeat ;
    }
    [class*="typing-"] {
      background: transparent ;
      position: absolute ;
      top: -15px ;
      height: 15px ;
      box-sizing: border-box ;
      padding: 0 15px ;

      [class*="text-"] { line-height: 15px }

      [class*="spinner-"] { margin: 0 }

      [class*="cooldownWrapper-"] {
        font-size: 0 ;

        [class*="slowModeIcon-"] {
          margin: 0 ;
          height: 15px ;

          path { fill: var(--Color_2) }
        }
      }
    }
  }
}

// Member-list
[class*="membersWrap-"] [class*="scroller-"] {

  &::-webkit-scrollbar { display: none }

  [class*="member-"] {
    border-radius: 0 ;
    height: 37px ;
    margin: 4px 0 4px 14px ;
    color: var(--Color_1) ;
    
    &:hover {
      border-right: 3px solid var(--Color_1) ;
      background: rgba(255, 255, 255, 0.05) ;
    }
    
    &.popout-open { border-right: 3px solid var(--Color_1) }

    &[class*="memberOffline-"] { 
      color: var(--Color_2) ;
      
      &:not(:hover) [class*="avatarWrapper-"] img {
        filter: grayscale(100%);
        border-radius: 50% ;
      }
    }
    
    [class*="avatarWrapper-"] {
      
      foreignObject img {
        filter: opacity(100%);
        border-radius: 50% ;
      }
    }
  }
}

// Server-bar
[class*="layers-"] > [class*="layer-"] > [class*="flex-"] > [class*="wrapper-"] {
  //Server-Background 
  &::before {
    content: "";
    position: absolute ;
    height: 54px ;
    width: 100vw ;
    background: var(--Background_Server) !important ;
    background-repeat: no-repeat !important ;
    background-position: center !important ;
    transform: rotate(90deg) translateX(-54px) ;
    transform-origin: bottom left ;
  }
  //Server-Brightness
  [class*="scrollerWrap-"] { 
    @include BG-dark-before(100vw);
    &::before { 
      opacity: calc(var(--brightness_Server) / 100 ) ;
      width: 54px ;
    }
  }
  //Server-bar
  [class*="scroller-"] {

    &::after, &::before { background: var(--Color_2) }
    
    // Server Icon Obj
    [class*="listItem-"] {
      // can cause bugs, for some reason
      filter: drop-shadow( -2px 2px 3px rgba(0, 0, 0, var(--Server_shadow, 0)) );
      
      // unread messages, Server selected
      [class*="pill-"] [class*="item-"] { background-color: var(--Color_1) }
      
      foreignObject [class*="wrapper-"] {
        
        //Text Color
        [class*="acronym-"] { 
          color: var(--Color_1);
          filter: drop-shadow( -2px 2px 3px rgba(0, 0, 0, var(--Server_shadow, 0)) );
        }
      }
      
      // guild seperator, Discovereeeeee
      &:nth-last-of-type(2), 
      &:last-child, 
      &:nth-last-of-type(3):not(.bd-guild) {
        [class*="circleIconButton-"] {
          color: var(--Color_1) ;
          opacity: .75 ;
        }
        
        &:hover [class*="circleIconButton-"] { opacity: 1 }
      }
      
      // Public Server List
      &#bd-pub-li [class*="wrapper-"] { color: var(--Color_1) }
    }
    
    // Server Folders
    > [class*="wrapper-"] > [class*="expandedGuilds-"]::after { background-color: var(--Color_2) }
  }
}

// Server-Name/Options
[class*="channels-"] > [class*="flex-"] > [class*="flexChild-"] {
  [class*="header-"] [class*="name-"] { color: var(--Color_1) }
}

// DM's
[class*="channels-"] > [class*="privateChannels-"] {
  top: 48px ;
  margin-bottom: 48px;

  // Bottom Right Search-bar
  > [class*="searchBar-"] {

    &::after { 
      color: var(--Color_1) ;
      opacity: .7 ;
    }
    &:hover::after { opacity: 1; }
  }

  // Friends-channel
  [class*="scroller-"] {
    padding-top: 0 !important ;

    &::-webkit-scrollbar {display: none }

    [class*="channel-"] {

      a { background: transparent }
      [class*="wrapper-"] > [class*="status-"] { border-color: transparent }
      [class*="close-"] { background-size: 22px 22px }
      [class*="name-"] { color: var(--Color_2) }

      &:hover [class*="name-"] { color: var(--Color_1) }

      &[class*="selected-"] [class*="name-"] { color: var(--Color_1) }
    }
  }
}

// Friends-list
[class*="channels-"] ~ [class*="container-"] {

  > [class*="headerBar-"] {

  }

  > [class*="friendsTable-"] {

    [class*="friendsTableHeader-"] { display: none }

    [class*="scroller-"] {
      &::-webkit-scrollbar { display: none }
      margin-left: 20px ;

      [class*="friendsRow-"] {
        position: relative ;
        display: inline-block ;
        border: none ;
        margin: 20px ;
        background: black ;
        width: 350px ;
        height: 80px !important ;
        box-shadow: 0 10px 60px black ;
        border-bottom-right-radius: 10px ;

        &:hover { 
          padding: 0 ;
          border-radius: 0 ;
          border-bottom-right-radius: 10px ;
        }

        [class*="friendsColumn-"] {
          display: block ;

          // Avatar, Name
          &[class*="friendsColumnName-"] {
            position: absolute ;
            pointer-events: none ;
            z-index: 1 ;

            [class*="avatarSmall-"] {
              height: 80px !important;
              width: 80px !important;
              margin: 0 0 0 5px ;

              img { filter: opacity(100%) }
            }

            [class*="nameTag-"] {
              position: absolute ;
              display: block ;
              top: 10px ;
              left: 95px ;
              width: 255px ;
              font-size: 20px ;
              color: var(--Color_1) ;

              [class*="username-"] {
                display: inline-block ;
                height: 35px ;
              }

              [class*="discriminator-"] {
                float: right ;
                margin-right: 5px ;
                color: var(--Color_1) ;
                visibility: visible ;
              }
            }
          }
          // Status
          &[class*="friendsColumnStatus-"] {
            position: absolute ;
            width: 100% ;
            margin: 0 ;
            pointer-events: none ;

            [class*="status-"] {
              
              svg {
                overflow: visible ;
                
                mask { display: none }
                
                rect {
                  height: 80px ;
                  width: 350px ;
                  opacity: .8 ;
                }
              }
            }

            [class*="statusText-"] {
              position: absolute ;
              width: 240px ;
              height: 45px ;
              bottom: 0 ;
              right: 5px ;
              top: 35px ;

              [class*="friendActivityText-"] {

                strong {
                  position: absolute ;
                  left: 0 ;
                  top: 20px ;
                  max-width: 240px ;
                  overflow: hidden ;
                  text-overflow: ellipsis ;
                }
              }
              
              [class*="friendActivityIcon-"] { display: none }
            }
          }
          // same Guilds
          &[class*="friendsColumnGuilds-"] { display: none !important }
          // Profile Options
          &[class*="friendsColumnActions-"] {
            margin-left: 100px ;
            text-align: center ;
            margin-top: 40px ;
            padding: 0 ;

            [class*="friendsAction-"] {
              display: inline-block ;
              margin: 0 20px ;
              background-color: transparent ;
              opacity: .6 ;

              &:hover { opacity: .9 }
            }
          }
        }
        &:hover {
          [class*="friendsColumnStatus-"] [class*="statusText-"] { display: none }
        }
      }
    }
  }
}

// Activity-Feed
[class*="channels-"] ~ [class*="activityFeed-"] [class*="scroller-"] {
  background: transparent ;
  
  [class*="wrappedCard-"] {
    background: transparent ;
    
    [class*="wrapper-"] {
      padding-bottom: 10px ;
    }
  }
  
  [class*="outer-"] {
    background: transparent ;
    
    [class*="card-"] {
      background: transparent ;
      
      [class*="body-"] [class*="section-"] {
        background: transparent ;
      }
    }
  }
}

// Settings Tab
[class*="layers-"] > [class*="layer-"]:nth-child(2) [class*="standardSidebarView-"] {
  
  // Side bar
  [class*="sidebarRegion-"] [class*="scroller-"]{
    &::-webkit-scrollbar { display: none }
    
    [class*="sidebar-"] [class*="side-"] {
      
      // Header
      [class*="header-"], .ui-tab-bar-header { 
        color: var(--Color_1) !important ;
        opacity: .8 ;
      }
      
      // Settings Tab-Obj
      [class*="item-"], .ui-tab-bar-item {
        color: var(--Color_2) !important ;
        background: transparent !important ;
        border-radius: 0 !important ;
        padding: 4px 10px 4px 10px  !important ;
        margin: 2px 0 4px 0 !important ;
        
        &:hover {
          color: var(--Color_1) !important ;
        }
      }
      [class*="item-"][class*="selected-"], .ui-tab-bar-item.selected {
        border-left: 2px solid var(--Color_1) ;
        color: var(--Color_1) !important ;
      }
    }
  }
  
  // Content
  [class*="contentRegion-"] {
    
  }
}

// Popouts
[class*="popouts-"] {
  
  // Server-Options -hopefully-
  [class*="popoutInvert-"][class*="noArrow-"][class*="popout-"][class*="popoutTop-"][class*="arrowAlignmentTop-"]:not([class*="popoutBottom-"]):not([class*="popoutTopLeft-"]):not([class*="popoutBottomRight-"]):not([class*="popoutBottomLeft-"]) [class*="menu-"] { 
    background: var(--Color_3) ;

    [class*="separator-"] {
      display: none ;
    }
    [class*="item-"] {
      color: var(--Color_2) ;
      padding: 5px 14px ;
      margin: 5px 0 ;

      &:hover {
        color: var(--Color_1) ;
        background: transparent ;
        border-left: 2px solid var(--Color_1) ;
      }
    }
  }
  
  // Profile Popout
  [class*="userPopout-"] {
//    box-shadow: 2px 2px 10px black ;
    filter: drop-shadow(3px 3px 3px rgba(0, 0, 0, 0.75));

    [class*="header-"] {

      &[class*="headerNormal-"] {
        background-color: var(--Color_3) ;
      }
      &[class*="headerSpotify-"] {

        [class*="timeBarUserPopout-"] ~ [class*="flex-"] {
          display: none ;
        }
      }
      &[class*="headerPlaying-"] {
        background-color: var(--Color_3) ;
      }

      [class*="avatarWrapper-"] {
        filter: drop-shadow(3px 3px 3px rgba(0, 0, 0, 0.75));
      
        foreignObject img, [class*="avatarHintInner-"] {
          filter: opacity(100%);
          border-radius: 7.5% ;
        }
      }
    }
    
    > [class*="body-"] { background-color: var(--Color_4) }
    
    [class*="footer-"] {

      [class*="protip-"] { display: none }
    }
  }
  
  // Search-Popout
  .noArrow-3BYQ0Z.noShadow-321ZPm.popout-3sVMXz.popoutBottom-1YbShG.arrowAlignmentTop-iGQczz.popoutbottom {
    [class*="container-"] {
      background: var(--Color_3) ;
      box-shadow: 2px 2px 10px black ;
      
      [class*="resultsGroup-"] {
        
        [class*="option-"] {
          
          &:after { display: none }
        }
      }
    }
  }
}

// User Profile (modal)
[class*="modal-"] {

  // header
  [class*="topSection"] {
    background-color: var(--Color_3) ;
    
    [class*="header-"] {

      > [class*="avatar-"] {
        filter: drop-shadow( 2px 2px 3px black );

        img {
          filter: opacity(100%);
          border-radius: 7.5% ;
        }
      }
      
      // Colored Profile-Badges
//      [class*="profileBadgeWrapper-"] {
//        // Bravery
//        [class*="profileBadgeHypeSquadOnlineHouse1-"] {background-image: url(https://discordapp.com/assets/64ae1208b6aefc0a0c3681e6be36f0ff.svg)}
//        // Brilliance
//        [class*="profileBadgeHypeSquadOnlineHouse2-"] {background-image: url(https://discordapp.com/assets/48cf0556d93901c8cb16317be2436523.svg)}
//        // Balance
//        [class*="profileBadgeHypeSquadOnlineHouse3-"] {background-image: url(https://discordapp.com/assets/9fdc63ef8a3cc1617c7586286c34e4f1.svg)}
//        // EarlySupporter
//        [class*="profileBadgeEarlySupporter-"] {background-image: url(https://discordapp.com/assets/23e59d799436a73c024819f84ea0b627.svg)}
//        // Nitro
//        [class*="profileBadgePremium-"] {background-image: url(https://discordapp.com/assets/386884eecd36164487505ddfbac35a9d.svg)}
//        // Partenr
//        [class*="profileBadgePartner-"] {background-image: url(https://discordapp.com/assets/33fedf082addb91d88abc272b4b18daa.svg)}
//      }
    }
  }

   // body
  [class*="flex-"] > [class*="body-"] {
    background-color: var(--Color_4) ;
    
    [class*="userInfoSection-"]:last-child { border-color: var(--Color_3) }
    
    [class*="connectedAccounts-"] > [class*="flex-"]{
      border: none ;
      
      [class*="connectedAccountName-"] {
        color:  var(--Color_2) ;
      }
    }
  }
}

// Discoveree
[class*="flex-"] > [class*="flex-"] > [class*="pageWrapper-"] {
  
  background: transparent ;
  
  > img { display: none }
  
  [class*="scroller-"] {
    
    &::-webkit-scrollbar-track { background: transparent }
    &::-webkit-scrollbar-thumb { background-color: var(--Color_2) }
    
    [class*="body-"] {
      
      [class*="search-"] [class*="searchBox-"] {
        border-radius: 0 ;
        background: transparent ;
        box-shadow: 0 2px 0px 0 var(--Color_2) ;
      }
    }
  }
}

// Tooltips
[class*="layerContainer-"] [class*="tooltip-"] {
  background-color: var(--Color_3) ;
  z-index: 3002 ;

  [class*="tooltipPointer-"] {
    border-top-color: var(--Color_3) ;
  }
}
